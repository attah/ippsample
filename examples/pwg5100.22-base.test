#
# Basic tests for conformance with PWG 5100.22-2019
#
# Usage:
#
#   ./ipptool -tIf FILENAME system-uri pwg5100.22-base.test
#
# Copyright © 2022 by the IEEE-ISTO Printer Working Group.
#
# Licensed under Apache License v2.0.  See the file "LICENSE" for more
# information.
#

{
    NAME "PWG 5100.22-2019: Required Attributes and Values"
    VERSION 2.0
    OPERATION Get-System-Attributes
    GROUP operation-attributes-tag
    ATTR charset attributes-charset utf-8
    ATTR naturalLanguage attributes-natural-language en
    ATTR uri system-uri $uri

    STATUS successful-ok

    EXPECT charset-configured IN-GROUP system-attributes-tag OF-TYPE charset COUNT 1
    EXPECT charset-supported IN-GROUP system-attributes-tag OF-TYPE charset
    EXPECT charset-supported WITH-VALUE "utf-8"

    EXPECT document-format-supported IN-GROUP system-attributes-tag OF-TYPE mimeMediaType

    EXPECT generated-natural-language-supported IN-GROUP system-attributes-tag OF-TYPE naturalLanguage WITH-VALUE "en"
    EXPECT natural-language-configured IN-GROUP system-attributes-tag OF-TYPE naturalLanguage COUNT 1

    EXPECT ippget-event-life IN-GROUP system-attributes-tag OF-TYPE integer(15:MAX) COUNT 1

    EXPECT ipp-features-supported IN-GROUP system-attributes-tag OF-TYPE keyword
    EXPECT ipp-features-supported WITH-VALUE "resource-object"
    EXPECT ipp-features-supported WITH-VALUE "system-object"
    EXPECT ipp-features-supported WITH-VALUE "infrastructure-printer" DEFINE-MATCH HAVE_INFRASTRUCTURE

    EXPECT ipp-versions-supported IN-GROUP system-attributes-tag OF-TYPE keyword
    EXPECT ipp-versions-supported WITH-VALUE "2.0"

    EXPECT multiple-document-printers-supported IN-GROUP system-attributes-tag OF-TYPE boolean COUNT 1

    EXPECT notify-attributes-supported IN-GROUP system-attributes-tag OF-TYPE keyword

    EXPECT notify-events-default IN-GROUP system-attributes-tag OF-TYPE keyword
    EXPECT notify-events-supported IN-GROUP system-attributes-tag OF-TYPE keyword
    EXPECT notify-events-supported WITH-VALUE "none"
    EXPECT notify-events-supported WITH-VALUE "printer-config-changed"
    EXPECT notify-events-supported WITH-VALUE "printer-created"
    EXPECT notify-events-supported WITH-VALUE "printer- deleted"
    EXPECT notify-events-supported WITH-VALUE "printer-state-changed"
    EXPECT notify-events-supported WITH-VALUE "printer-stopped"
    EXPECT notify-events-supported WITH-VALUE "resource-canceled"
    EXPECT notify-events-supported WITH-VALUE "resource-config-changed"
    EXPECT notify-events-supported WITH-VALUE "resource-created"
    EXPECT notify-events-supported WITH-VALUE "resource-installed"
    EXPECT notify-events-supported WITH-VALUE "resource-state-changed"
    EXPECT notify-events-supported WITH-VALUE "system-config-changed"
    EXPECT notify-events-supported WITH-VALUE "system-restarted"
    EXPECT notify-events-supported WITH-VALUE "system-shutdown"
    EXPECT notify-events-supported WITH-VALUE "system-state-changed"
    EXPECT notify-events-supported WITH-VALUE "system-stopped"

    EXPECT notify-lease-duration-default IN-GROUP system-attributes-tag OF-TYPE integer(0:67108863) COUNT 1
    EXPECT notify-lease-duration-supported IN-GROUP system-attributes-tag OF-TYPE integer(0:67108863)|rangeOfInteger(0:67108863)

    EXPECT notify-max-events-supported IN-GROUP system-attributes-tag OF-TYPE integer(2:MAX)

    EXPECT notify-pull-method-supported IN-GROUP system-attributes-tag OF-TYPE keyword
    EXPECT notify-pull-method-supported WITH-VALUE "ippget"

    EXPECT ?notify-schemes-supported IN-GROUP system-attributes-tag OF-TYPE uriScheme

    EXPECT operations-supported IN-GROUP system-attributes-tag OF-TYPE enum
    EXPECT operations-supported WITH-VALUE 0x000B # Get-Printer-Attributes
    EXPECT operations-supported WITH-VALUE 0x0018 # Get-Subscription-Attributes
    EXPECT operations-supported WITH-VALUE 0x0019 # Get-Subscriptions
    EXPECT operations-supported WITH-VALUE 0x001A # Renew-Subscription
    EXPECT operations-supported WITH-VALUE 0x001B # Cancel-Subscription
    EXPECT operations-supported WITH-VALUE 0x001C # Get-Notifications
    EXPECT operations-supported WITH-VALUE 0x001E # Get-Resource-Attributes
    EXPECT operations-supported WITH-VALUE 0x0020 # Get-Resources
    EXPECT operations-supported WITH-VALUE 0x004B # Allocate-Printer-Resources
    EXPECT operations-supported WITH-VALUE 0x004C # Create-Printer
    EXPECT operations-supported WITH-VALUE 0x004D # Deallocate-Printer-Resources
    EXPECT operations-supported WITH-VALUE 0x004E # Delete-Printer
    EXPECT operations-supported WITH-VALUE 0x004F # Get-Printers
    EXPECT operations-supported WITH-VALUE 0x0050 # Shutdown-One-Printer
    EXPECT operations-supported WITH-VALUE 0x0051 # Startup-One-Printer
    EXPECT operations-supported WITH-VALUE 0x0052 # Cancel-Resource
    EXPECT operations-supported WITH-VALUE 0x0053 # Create-Resource
    EXPECT operations-supported WITH-VALUE 0x0054 # Install-Resource
    EXPECT operations-supported WITH-VALUE 0x0055 # Send-Resource-Data
    EXPECT operations-supported WITH-VALUE 0x0056 # Set-Resource-Attributes
    EXPECT operations-supported WITH-VALUE 0x0057 # Create-Resource-Subscriptions
    EXPECT operations-supported WITH-VALUE 0x0058 # Create-System-Subscriptions
    EXPECT operations-supported WITH-VALUE 0x0059 # Disable-All-Printers
    EXPECT operations-supported WITH-VALUE 0x005A # Enable-All-Printers
    EXPECT operations-supported WITH-VALUE 0x005B # Get-System-Attributes
    EXPECT operations-supported WITH-VALUE 0x005C # Get-System-Supported-Values
    EXPECT operations-supported WITH-VALUE 0x005D # Pause-All-Printers
    EXPECT operations-supported WITH-VALUE 0x005E # Pause-All-Printers-After-Current-Job
    EXPECT operations-supported WITH-VALUE 0x005F IF-DEFINED HAVE_INFRASTRUCTURE # Register-Output-Device
    EXPECT operations-supported WITH-VALUE 0x0060 # Restart-System
    EXPECT operations-supported WITH-VALUE 0x0061 # Resume-All-Printers
    EXPECT operations-supported WITH-VALUE 0x0062 # Set-System-Attributes
    EXPECT operations-supported WITH-VALUE 0x0063 # Shutdown-All-Printers
    EXPECT operations-supported WITH-VALUE 0x0064 # Startup-All-Printers
    EXPECT operations-supported WITH-VALUE 0x0065 # Get-Printer-Resources
    EXPECT operations-supported WITH-VALUE 0x0067 # Restart-One-Printer

    EXPECT power-calendar-policy-col IN-GROUP system-attributes-tag OF-TYPE collection DEFINE-MATCH HAVE_POWER_CALENDAR
    EXPECT power-calendar-policy-col/calendar-id OF-TYPE integer(1:MAX) COUNT 1 IF-DEFINED HAVE_POWER_CALENDAR
    EXPECT power-calendar-policy-col/request-power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_CALENDAR
    EXPECT power-calendar-policy-col/run-once OF-TYPE boolean COUNT 1 IF-DEFINED HAVE_POWER_CALENDAR

    EXPECT power-event-policy-col IN-GROUP system-attributes-tag OF-TYPE collection DEFINE-MATCH HAVE_POWER_EVENT
    EXPECT power-event-policy-col/event-id OF-TYPE integer(1:MAX) COUNT 1 IF-DEFINED HAVE_POWER_EVENT
    EXPECT power-event-policy-col/event-name OF-TYPE name(127) COUNT 1 IF-DEFINED HAVE_POWER_EVENT
    EXPECT power-event-policy-col/request-power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_EVENT

    EXPECT power-log-col IN-GROUP system-attributes-tag OF-TYPE collection DEFINE-MATCH HAVE_POWER_LOG
    EXPECT power-log-col/log-id OF-TYPE integer(1:MAX) COUNT 1 IF-DEFINED HAVE_POWER_LOG
    EXPECT power-log-col/power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_LOG
    EXPECT power-log-col/power-state-date-time OF-TYPE dateTime COUNT 1 IF-DEFINED HAVE_POWER_LOG

    EXPECT power-state-capabilities-col IN-GROUP system-attributes-tag OF-TYPE collection DEFINE-MATCH HAVE_POWER_CAPS
    EXPECT power-state-capabilities-col/can-accept-jobs OF-TYPE boolean COUNT 1 IF-DEFINED HAVE_POWER_CAPS
    EXPECT power-state-capabilities-col/can-process-jobs OF-TYPE boolean COUNT 1 IF-DEFINED HAVE_POWER_CAPS
    EXPECT power-state-capabilities-col/power-active-watts OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_CAPS
    EXPECT power-state-capabilities-col/power-inactive-watts OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_CAPS
    EXPECT power-state-capabilities-col/power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_CAPS

    EXPECT power-state-counters-col IN-GROUP system-attributes-tag OF-TYPE collection DEFINE-MATCH HAVE_POWER_COUNTERS
    EXPECT power-state-counters-col/hibernate-transitions OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_COUNTERS
    EXPECT power-state-counters-col/on-transitions OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_COUNTERS
    EXPECT power-state-counters-col/standby-transitions OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_COUNTERS
    EXPECT power-state-counters-col/suspend-transitions OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_COUNTERS

    EXPECT power-state-monitor-col IN-GROUP system-attributes-tag OF-TYPE collection COUNT 1 DEFINE-MATCH HAVE_POWER_MONITOR
    EXPECT power-state-monitor-col/current-month-kwh OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_MONITOR
    EXPECT power-state-monitor-col/current-watts OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_MONITOR
    EXPECT power-state-monitor-col/lifetime-kwh OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_MONITOR
    EXPECT power-state-monitor-col/meters-at-actual OF-TYPE boolean COUNT 1 IF-DEFINED HAVE_POWER_MONITOR
    EXPECT power-state-monitor-col/power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_MONITOR
    EXPECT power-state-monitor-col/power-state-message OF-TYPE text(255) COUNT 1 IF-DEFINED HAVE_POWER_MONITOR
    EXPECT power-state-monitor-col/power-state-usage-is-rms OF-TYPE boolean COUNT 1 IF-DEFINED HAVE_POWER_MONITOR

    EXPECT power-timeout-policy-col IN-GROUP system-attributes-tag OF-TYPE collection DEFINE-MATCH HAVE_POWER_TIMEOUT
    EXPECT power-timeout-policy-col/request-power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_TIMEOUT
    EXPECT power-timeout-policy-col/start-power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_TIMEOUT
    EXPECT power-timeout-policy-col/timeout-id OF-TYPE integer(1:MAX) COUNT 1 IF-DEFINED HAVE_POWER_TIMEOUT
    EXPECT power-timeout-policy-col/timeout-predicate OF-TYPE keyword COUNT 1 IF-DEFINED HAVE_POWER_TIMEOUT
    EXPECT power-timeout-policy-col/timeout-seconds OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_TIMEOUT

    EXPECT power-transitions-policy-col IN-GROUP system-attributes-tag OF-TYPE collection DEFINE-MATCH HAVE_POWER_TRANSITIONS
    EXPECT power-transitions-policy-col/end-power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_TRANSITIONS
    EXPECT power-transitions-policy-col/start-power-state OF-TYPE enum COUNT 1 IF-DEFINED HAVE_POWER_TRANSITIONS
    EXPECT power-transitions-policy-col/state-transition-seconds OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_POWER_TRANSITIONS

    EXPECT printer-creation-attributes-supported IN-GROUP system-attributes-tag OF-TYPE keyword

    EXPECT printer-service-type-supported IN-GROUP system-attributes-tag OF-TYPE keyword

    EXPECT resource-format-supported IN-GROUP system-attributes-tag OF-TYPE mimeMediaType

    EXPECT resource-type-supported IN-GROUP system-attributes-tag OF-TYPE keyword

    EXPECT resource-settable-attributes-supported IN-GROUP system-attributes-tag OF-TYPE keyword

    EXPECT system-config-change-date-time IN-GROUP system-attributes-tag OF-TYPE dateTime COUNT 1
    EXPECT system-config-change-time IN-GROUP system-attributes-tag OF-TYPE integer COUNT 1
    EXPECT system-config-changes IN-GROUP system-attributes-tag OF-TYPE integer COUNT 1

    EXPECT system-configured-printers IN-GROUP system-attributes-tag OF-TYPE collection|no-value
    EXPECT system-configured-printers/printer-id OF-TYPE integer(1:65535) COUNT 1
    EXPECT system-configured-printers/printer-info OF-TYPE text(127) COUNT 1
    EXPECT system-configured-printers/printer-is-accepting-jobs OF-TYPE boolean COUNT 1
    EXPECT system-configured-printers/printer-name OF-TYPE name(127) COUNT 1
    EXPECT system-configured-printers/printer-service-type OF-TYPE keyword COUNT 1
    EXPECT system-configured-printers/printer-state OF-TYPE enum COUNT 1
    EXPECT system-configured-printers/printer-state-reasons OF-TYPE keyword
    EXPECT system-configured-printers/printer-xri-supported OF-TYPE collection

    EXPECT system-configured-resources IN-GROUP system-attributes-tag OF-TYPE collection|no-value
    EXPECT system-configured-resource/resource-format OF-TYPE mimeMediaType COUNT 1
    EXPECT system-configured-resource/resource-id OF-TYPE integer(1:MAX) COUNT 1
    EXPECT system-configured-resource/resource-info OF-TYPE text(127) COUNT 1
    EXPECT system-configured-resource/resource-name OF-TYPE name(127) COUNT 1
    EXPECT system-configured-resource/resource-state OF-TYPE enum COUNT 1
    EXPECT system-configured-resource/resource-state-reasons OF-TYPE keyword
    EXPECT system-configured-resource/resource-type OF-TYPE keyword COUNT 1

    EXPECT system-contact-col IN-GROUP system-attributes-tag OF-TYPE collection|no-value COUNT 1
    EXPECT system-contact-col/contact-name OF-TYPE name COUNT 1

    EXPECT system-current-time IN-GROUP system-attributes-tag OF-TYPE dateTime COUNT 1
    EXPECT system-up-time IN-GROUP system-attributes-tag OF-TYPE integer COUNT 1

    EXPECT system-default-printer-id IN-GROUP system-attributes-tag OF-TYPE integer(1:65535)|no-value COUNT 1

    EXPECT system-device-id IN-GROUP system-attributes-tag OF-TYPE text COUNT 1

    EXPECT system-firmware-name IN-GROUP system-attributes-tag OF-TYPE name(MAX)
    EXPECT system-firmware-patches IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-firmware-name
    EXPECT system-firmware-string-version IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-firmware-name
    EXPECT system-firmware-version IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-firmware-name

    EXPECT system-geo-location IN-GROUP system-attributes-tag OF-TYPE uri|unknown COUNT 1

    EXPECT ?system-impressions-completed IN-GROUP system-attributes-tag OF-TYPE integer(0:MAX) COUNT 1
    EXPECT system-impressions-completed-col IN-GROUP system-attributes-tag OF-TYPE integer(0:MAX) COUNT 1 DEFINE-MATCH HAVE_IMPRESSIONS
    EXPECT system-impressions-completed-col/blank OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_IMPRESSIONS
    EXPECT system-impressions-completed-col/blank-two-sided OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_IMPRESSIONS
    EXPECT system-impressions-completed-col/full-color OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_IMPRESSIONS
    EXPECT system-impressions-completed-col/full-color-two-sided OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_IMPRESSIONS
    EXPECT system-impressions-completed-col/highlight-color OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_IMPRESSIONS
    EXPECT system-impressions-completed-col/highlight-color-two-sided OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_IMPRESSIONS
    EXPECT system-impressions-completed-col/monochrome OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_IMPRESSIONS
    EXPECT system-impressions-completed-col/monochrome-two-sided OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_IMPRESSIONS

    EXPECT system-info IN-GROUP system-attributes-tag OF-TYPE text(127) COUNT 1

    EXPECT system-location IN-GROUP system-attributes-tag OF-TYPE text(127) COUNT 1

    EXPECT system-make-and-model IN-GROUP system-attributes-tag OF-TYPE text(127) COUNT 1

    EXPECT system-mandatory-printer-attributes IN-GROUP system-attributes-tag OF-TYPE keyword

    EXPECT ?system-media-sheets-completed IN-GROUP system-attributes-tag OF-TYPE integer(0:MAX) COUNT 1
    EXPECT system-media-sheets-completed-col IN-GROUP system-attributes-tag OF-TYPE integer(0:MAX) COUNT 1 DEFINE-MATCH HAVE_SHEETS
    EXPECT system-media-sheets-completed-col/blank OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_SHEETS
    EXPECT system-media-sheets-completed-col/full-color OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_SHEETS
    EXPECT system-media-sheets-completed-col/highlight-color OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_SHEETS
    EXPECT system-media-sheets-completed-col/monochrome OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_SHEETS

    EXPECT ?system-message-from-operator IN-GROUP system-attributes-tag OF-TYPE text(127) COUNT 1

    EXPECT system-name IN-GROUP system-attributes-tag OF-TYPE name(127) COUNT 1

    EXPECT system-owner-col IN-GROUP system-attributes-tag OF-TYPE collection COUNT 1
    EXPECT system-owner-col/contact-name OF-TYPE name COUNT 1

    EXPECT ?system-pages-completed IN-GROUP system-attributes-tag OF-TYPE integer(0:MAX) COUNT 1
    EXPECT system-pages-completed-col IN-GROUP system-attributes-tag OF-TYPE integer(0:MAX) COUNT 1 DEFINE-MATCH HAVE_PAGES
    EXPECT system-pages-completed-col/full-color OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_PAGES
    EXPECT system-pages-completed-col/monochrome OF-TYPE integer(0:MAX) COUNT 1 IF-DEFINED HAVE_PAGES

    EXPECT system-resident-application-name IN-GROUP system-attributes-tag OF-TYPE name(MAX)
    EXPECT system-resident-application-patches IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-resident-application-name
    EXPECT system-resident-application-string-version IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-resident-application-name
    EXPECT system-resident-application-version IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-resident-application-name

    EXPECT system-serial-number IN-GROUP system-attributes-tag OF-TYPE name(255) COUNT 1

    EXPECT system-settable-attributes-supported IN-GROUP system-attributes-tag OF-TYPE keyword

    EXPECT system-state IN-GROUP system-attributes-tag OF-TYPE enum COUNT 1
    EXPECT system-state-change-date-time IN-GROUP system-attributes-tag OF-TYPE dateTime COUNT 1
    EXPECT system-state-change-time IN-GROUP system-attributes-tag OF-TYPE integer COUNT 1
    EXPECT system-state-message IN-GROUP system-attributes-tag OF-TYPE text COUNT 1
    EXPECT system-state-reasons IN-GROUP system-attributes-tag OF-TYPE keyword

    EXPECT system-strings-languages-supported IN-GROUP system-attributes-tag OF-TYPE naturalLanguage DEFINE-MATCH HAVE_STRINGS
    EXPECT system-strings-uri IN-GROUP system-attributes-tag OF-TYPE uri|no-value COUNT 1 IF-DEFINED HAVE_STRINGS

    EXPECT system-user-application-name IN-GROUP system-attributes-tag OF-TYPE name(MAX)
    EXPECT system-user-application-patches IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-user-application-name
    EXPECT system-user-application-string-version IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-user-application-name
    EXPECT system-user-application-version IN-GROUP system-attributes-tag OF-TYPE SAME-COUNT-AS system-user-application-name

    EXPECT system-uuid IN-GROUP system-attributes-tag OF-TYPE uri COUNT 1

    EXPECT system-xri-supported IN-GROUP system-attributes-tag OF-TYPE collection
    EXPECT system-xri-supported/xri-authentication OF-TYPE keyword COUNT 1
    EXPECT system-xri-supported/xri-security OF-TYPE keyword COUNT 1
    EXPECT system-xri-supported/xri-uri OF-TYPE uri COUNT 1

    EXPECT xri-authentication-supported IN-GROUP system-attributes-tag OF-TYPE keyword
    EXPECT xri-security-supported IN-GROUP system-attributes-tag OF-TYPE keyword
    EXPECT xri-uri-scheme-supported IN-GROUP system-attributes-tag OF-TYPE uriScheme
}
